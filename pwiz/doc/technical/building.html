<html>

<head>
    <title>ProteoWizard Documentation: Building ProteoWizard</title>
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
</head>

<body>

    <h1>Building ProteoWizard</h1>
    <hr/>

    <h2>Subversion Snapshot</h2>
    <p>
        Use the following command to check out a snapshot of the current ProteoWizard
        source code: <br/>
        <code>
            svn checkout
            https://proteowizard.svn.sourceforge.net/
            svnroot/proteowizard/trunk/pwiz
            your_local_directory 
        </code>
    </p>

    <h2>Library Dependencies</h2>
    <p>
        Tested versions of all of ProteoWizard's library dependencies can be found
        in &lt;project-root&gt;/libraries.  Simply extract the libraries you need.</p>
    <p>
        The following libraries are used by the ProteoWizard projects:
        <ul>
            <li><h3>Boost</h3> Several of the Boost C++ libraries 
                are used, including <code>filesystem</code> for platform-independent filesystem
                access, <code>program_options</code> for handling command-line parameters,
                <code>ublas</code> for linear algebra routines, and <code>Boost.Build</code>
                for platform-independent build files. 
                <a href="http://boost.org" target="_blank">http://boost.org</a>
            </li>

            <li><h3>gd</h3> 
                The <code>gd</code> graphics library is used by <code>mspp</code> for creating
                images of mass spectra.
                <a href="http://www.libgd.org" target="_blank">http://www.libgd.org</a>
            </li>

            <li><h3>fftw</h3>
                The <code>fftw</code> Fourier Transform library is used for processing
                FTMS transient data.
                <a href="http://www.fftw.org" target="_blank">http://www.fftw.org</a>
            </li>

            <li><h3>XCalibur</h3>
                Thermo-Fisher's XCalibur software provides the <code>XRawfile2</code> 
                COM object, which is used by the ProteoWizard <code>rawfile</code> library 
                for accessing Thermo RAW files.
        </ul>
    </p>

    <h2>Build Tools</h2>
    <p>
        <code>ProteoWizard</code> uses Boost.Build, a cross-platform build framework.
        See <a href="http://boost.org/boost-build2" target="_blank">http://boost.org/boost-build2</a> for Boost.Build documentation.
    </p>
    <p>
        The project builds with <code>gcc</code> on Linux, and
        with <code>msvc</code> and <code>gcc</code> on Windows/cygwin.
    </p>
    <p>
        Microsoft provides a free Visual C++ compiler and Platform SDK:<br/>
        <a href="http://msdn.microsoft.com/vstudio/express/visualc/usingpsdk" target="_blank">http://msdn.microsoft.com/vstudio/express/visualc/usingpsdk</a>
    </p>

    <h2>Build Setup</h2>
    <p>
        In order to build ProteoWizard, the library dependencies must be installed.    
        It is assumed that your compiler can find headers and libs through
        your environment.
    </p>
    <p>
        If you're on a Unix-like system and you have root access, you can install everything 
        (including Boost.Build) to standard locations (i.e. /usr/local/*) and everything 
        should work properly.
    </p>
    <p>
        Otherwise, you must do the following:
        <ul>
            <li>Install and configure Boost.Build <br/>
                
            <ol>
            	<li>extract &lt;project-root&gt;/libraries/boost-build.tar.bz2</li>
            	<li><span class="bold"><strong><a class="external" href="http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=72941" target="_top">download
          			a prebuilt bjam executable</a></strong></span> from SourceForge.
                <li><code>bjam</code> executable must be in <code>PATH</code></li>
                <li><code>bjam</code> must be able to find Boost.Build root in one of the 
                    following ways:
                    <ul>
                        <li>default location: <code>/usr/share/boost-build</code></li>
                        <li><code>BOOST_BUILD_PATH</code> environment variable</li>
                        <li><code>boost-build.jam</code> file in current working directory with line:<br/>
                            <code>&nbsp; boost-build  /path/to/boost.build  ; &nbsp; # Note the space before semicolons! </code>
                        </li>
                    </ul>
                </li>

                <li><code>user-config.jam</code> must contain proper toolset configuration
                <ul>
                    <li>located in <code>$HOME</code> or <code>$BOOST_BUILD_PATH</code></li>
                    <li>contains the lines:<br/>
                    <code>
                    &nbsp; using gcc ; <br/>
                    &nbsp; using msvc ; <br/>
                    </code>
                    </li>
                </ul>
                </li>
            </ol>
            </li>
            <li>Setup the environment so your compiler(s) can find the appropriate headers
                and libs for the library dependencies:
            <ul>
                <li>gcc: <br/>
                    &nbsp; export CPLUS_INCLUDE_PATH=~/local/include <br/>
                    &nbsp; export LIBRARY_PATH=~/local/lib <br/>
                </li>
                <li>msvc: <br/>
                    &nbsp; export INCLUDE='c:/local/include/' <br/>
                    &nbsp; export LIB='c:/local/lib' <br/>
                </li>
            </ul>
            </li>
        </ul> 
    </p>

    <p>
    Important note about Boost library builds:  Please see <code>pwiz/Jamroot</code> for details
    on Boost lib builds and filenames.
    </p>

    <p>
    Why is this so complicated, you ask?  We support cross-platform development with
    native compilers, i.e. the code must build with gcc on Linux and MSVC on Windows.
    Using a cross-platform build system is much easier to maintain, and less bug-prone,
    than maintaining platform-specific build files for each project.  Boost.Build also
    provides a very simple unit testing facility, which allows unit tests to be run
    as part of the normal build process.
    </p>


    <h2>Building</h2>
    <p>
        Boost.Build uses portable build files called Jamfiles. <br/>
    </p>
    <p>
        <code>pwiz/Jamroot</code> is the root Jamfile that contains
        general project settings and library dependency declarations.
        &nbsp; 
        In particular, it contains compiler-specific settings that are shared
        across projects.
    </p>
        Each project has an associated <code>Jamfile</code> that contains directives
        describing how to build the executable or library, as well as instructions for
        building and running the unit tests for the project.
    <p>
        Example build commands:
        <ul>
            <li>Build all projects:<br/>
            <code> [pwiz/build] $ bjam </code>
            </li>

            <li>Build a particular project:<br/>
            <code> 
                [pwiz/project_name] $ bjam <br/>
                [pwiz] $ bjam project_name
            </code>
            </li>

            <li>Build a particular target:<br/>
            <code> 
                [pwiz/project_name] $ bjam target_name<br/>
                [pwiz] $ bjam project_name//target_name
            </code>
            </li>

            <li>Clean a project:<br/>
            <code>$ bjam --clean </code>
            </li>

            <li>Rebuild all, including dependencies:<br/>
            <code>$ bjam -a</code>
            </li>

            <li>Build with a particular compiler:<br/>
            <code>
                $ bjam gcc <br/>
                $ bjam msvc 
            </code>
            </li>

            <li>Build a particular variant:<br/>
            <code>
                $ bjam release<br/>
                $ bjam debug 
            </code>
            </li>

            <li>Build specifying multiple things:<br/>
            <code>
                $ bjam project_path//target_name -a msvc debug
            </code>
            </li>
        </ul>
    
        <br/>
    </p>

    <hr/>
    <a href="index.html">Technical documentation home</a>

</body>
</html>

