<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ProteoWizard: pwiz::math::MatchedFilter::details Namespace Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="namespaces.html"><span>Namespace List</span></a></li>
    <li><a href="namespacemembers.html"><span>Namespace&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespacepwiz.html">pwiz</a>::<a class="el" href="namespacepwiz_1_1math.html">math</a>::<a class="el" href="namespacepwiz_1_1math_1_1_matched_filter.html">MatchedFilter</a>::<a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html">details</a></div>
<h1>pwiz::math::MatchedFilter::details Namespace Reference</h1>
<p>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;typename Kernel&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::filter_type&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#dd3f5f6f64209b9e6d5727e66467e0f8">createFilter</a> (const Kernel &amp;kernel, int sampleRadius, typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::abscissa_type dx, typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::abscissa_type shift)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#313264101c8b982a32ec82d0d6f17529">norm</a> (double d)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#3b7550b90b2036dbe4d21425be648f35">conj</a> (double d)</td></tr>

<tr><td class="memTemplParams" nowrap colspan="2">template&lt;typename Filter&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#4c12b27d5ed479201948a74f726d19bf">normalizeFilter</a> (Filter &amp;filter)</td></tr>

<tr><td class="memTemplParams" nowrap colspan="2">template&lt;typename Kernel&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">std::vector&lt; typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt;<br>
 Kernel &gt;::filter_type &gt;&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#a7f7cfd3c7adaef22153d6dc1d6886e3">createFilters</a> (const Kernel &amp;kernel, int sampleRadius, int subsampleFactor, typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::abscissa_type dx)</td></tr>

<tr><td class="memTemplParams" nowrap colspan="2">template&lt;typename Kernel&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#34dae2fb6b7ea6905491c70a06e3c2f9">computeCorrelation</a> (typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::samples_type::const_iterator samples, typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::samples_type::const_iterator samplesEnd, typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::samples_type::const_iterator filter, typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt; Kernel &gt;::correlation_type &amp;result)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="dd3f5f6f64209b9e6d5727e66467e0f8"></a><!-- doxytag: member="pwiz::math::MatchedFilter::details::createFilter" ref="dd3f5f6f64209b9e6d5727e66467e0f8" args="(const Kernel &amp;kernel, int sampleRadius, typename KernelTraits&lt; Kernel &gt;::abscissa_type dx, typename KernelTraits&lt; Kernel &gt;::abscissa_type shift)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Kernel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt;Kernel&gt;::filter_type pwiz::math::MatchedFilter::details::createFilter           </td>
          <td>(</td>
          <td class="paramtype">const Kernel &amp;&nbsp;</td>
          <td class="paramname"> <em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sampleRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::abscissa_type&nbsp;</td>
          <td class="paramname"> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::abscissa_type&nbsp;</td>
          <td class="paramname"> <em>shift</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="_matched_filter_8hpp-source.html#l00201">201</a> of file <a class="el" href="_matched_filter_8hpp-source.html">MatchedFilter.hpp</a>.
<p>
Referenced by <a class="el" href="_matched_filter_8hpp-source.html#l00235">createFilters()</a>, and <a class="el" href="_matched_filter_test_8cpp-source.html#l00093">test_createFilter()</a>.<div class="fragment"><pre class="fragment"><a name="l00205"></a>00205 {
<a name="l00206"></a>00206     checkKernelConcept&lt;Kernel&gt;();
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <span class="keyword">typename</span> KernelTraits&lt;Kernel&gt;::filter_type filter;
<a name="l00209"></a>00209     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=-sampleRadius; i&lt;=sampleRadius; i++)
<a name="l00210"></a>00210         filter.push_back(kernel(i*dx - shift));
<a name="l00211"></a>00211     <span class="keywordflow">return</span> filter;
<a name="l00212"></a>00212 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="313264101c8b982a32ec82d0d6f17529"></a><!-- doxytag: member="pwiz::math::MatchedFilter::details::norm" ref="313264101c8b982a32ec82d0d6f17529" args="(double d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pwiz::math::MatchedFilter::details::norm           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>d</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="_matched_filter_8hpp-source.html#l00216">216</a> of file <a class="el" href="_matched_filter_8hpp-source.html">MatchedFilter.hpp</a>.
<p>
Referenced by <a class="el" href="_matched_filter_8hpp-source.html#l00256">computeCorrelation()</a>, <a class="el" href="_matched_filter_8hpp-source.html#l00221">normalizeFilter()</a>, <a class="el" href="_parametrized_function_8hpp-source.html#l00073">pwiz::peaks::ParametrizedFunction&lt; value_type &gt;::ErrorFunction::operator()()</a>, <a class="el" href="_matched_filter_test_8cpp-source.html#l00124">test_createFilters()</a>, <a class="el" href="_linear_solver_test_8cpp-source.html#l00221">testBandedComplex()</a>, and <a class="el" href="_peak_detector_matched_filter_test_8cpp-source.html#l00086">testFind()</a>.<div class="fragment"><pre class="fragment"><a name="l00216"></a>00216 {<span class="keywordflow">return</span> d*d;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3b7550b90b2036dbe4d21425be648f35"></a><!-- doxytag: member="pwiz::math::MatchedFilter::details::conj" ref="3b7550b90b2036dbe4d21425be648f35" args="(double d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pwiz::math::MatchedFilter::details::conj           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>d</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="_matched_filter_8hpp-source.html#l00217">217</a> of file <a class="el" href="_matched_filter_8hpp-source.html">MatchedFilter.hpp</a>.
<p>
Referenced by <a class="el" href="_matched_filter_8hpp-source.html#l00256">computeCorrelation()</a>, <a class="el" href="_parametrized_function_8hpp-source.html#l00081">pwiz::peaks::ParametrizedFunction&lt; value_type &gt;::ErrorFunction::dp()</a>, and <a class="el" href="_parametrized_function_8hpp-source.html#l00093">pwiz::peaks::ParametrizedFunction&lt; value_type &gt;::ErrorFunction::dp2()</a>.<div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 {<span class="keywordflow">return</span> d;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4c12b27d5ed479201948a74f726d19bf"></a><!-- doxytag: member="pwiz::math::MatchedFilter::details::normalizeFilter" ref="4c12b27d5ed479201948a74f726d19bf" args="(Filter &amp;filter)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Filter&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pwiz::math::MatchedFilter::details::normalizeFilter           </td>
          <td>(</td>
          <td class="paramtype">Filter &amp;&nbsp;</td>
          <td class="paramname"> <em>filter</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="_matched_filter_8hpp-source.html#l00221">221</a> of file <a class="el" href="_matched_filter_8hpp-source.html">MatchedFilter.hpp</a>.
<p>
References <a class="el" href="_matched_filter_8hpp-source.html#l00216">norm()</a>.<div class="fragment"><pre class="fragment"><a name="l00222"></a>00222 {
<a name="l00223"></a>00223     <span class="keywordtype">double</span> normalization = 0;
<a name="l00224"></a>00224     <span class="keywordflow">for</span> (<span class="keyword">typename</span> Filter::const_iterator it=filter.begin(); it!=filter.end(); ++it)
<a name="l00225"></a>00225         normalization += <a class="code" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#313264101c8b982a32ec82d0d6f17529">norm</a>(*it);
<a name="l00226"></a>00226     normalization = sqrt(normalization);
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="keywordflow">for</span> (<span class="keyword">typename</span> Filter::iterator it=filter.begin(); it!=filter.end(); ++it)
<a name="l00229"></a>00229         *it /= normalization;
<a name="l00230"></a>00230 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a7f7cfd3c7adaef22153d6dc1d6886e3"></a><!-- doxytag: member="pwiz::math::MatchedFilter::details::createFilters" ref="a7f7cfd3c7adaef22153d6dc1d6886e3" args="(const Kernel &amp;kernel, int sampleRadius, int subsampleFactor, typename KernelTraits&lt; Kernel &gt;::abscissa_type dx)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Kernel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;typename <a class="el" href="structpwiz_1_1math_1_1_matched_filter_1_1_kernel_traits.html">KernelTraits</a>&lt;Kernel&gt;::filter_type&gt; pwiz::math::MatchedFilter::details::createFilters           </td>
          <td>(</td>
          <td class="paramtype">const Kernel &amp;&nbsp;</td>
          <td class="paramname"> <em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sampleRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>subsampleFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::abscissa_type&nbsp;</td>
          <td class="paramname"> <em>dx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="_matched_filter_8hpp-source.html#l00235">235</a> of file <a class="el" href="_matched_filter_8hpp-source.html">MatchedFilter.hpp</a>.
<p>
References <a class="el" href="_matched_filter_8hpp-source.html#l00201">createFilter()</a>.
<p>
Referenced by <a class="el" href="_matched_filter_8hpp-source.html#l00282">pwiz::math::MatchedFilter::computeCorrelationData()</a>, and <a class="el" href="_matched_filter_test_8cpp-source.html#l00124">test_createFilters()</a>.<div class="fragment"><pre class="fragment"><a name="l00239"></a>00239 {
<a name="l00240"></a>00240     checkKernelConcept&lt;Kernel&gt;();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     <span class="keyword">typedef</span> <span class="keyword">typename</span> KernelTraits&lt;Kernel&gt;::filter_type filter_type;
<a name="l00243"></a>00243     std::vector&lt;filter_type&gt; filters;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;subsampleFactor; i++)
<a name="l00246"></a>00246         filters.push_back(<a class="code" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#dd3f5f6f64209b9e6d5727e66467e0f8">createFilter</a>(kernel, sampleRadius, dx, dx*i/subsampleFactor));
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     for_each(filters.begin(), filters.end(), normalizeFilter&lt;filter_type&gt;);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="keywordflow">return</span> filters;
<a name="l00251"></a>00251 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="34dae2fb6b7ea6905491c70a06e3c2f9"></a><!-- doxytag: member="pwiz::math::MatchedFilter::details::computeCorrelation" ref="34dae2fb6b7ea6905491c70a06e3c2f9" args="(typename KernelTraits&lt; Kernel &gt;::samples_type::const_iterator samples, typename KernelTraits&lt; Kernel &gt;::samples_type::const_iterator samplesEnd, typename KernelTraits&lt; Kernel &gt;::samples_type::const_iterator filter, typename KernelTraits&lt; Kernel &gt;::correlation_type &amp;result)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Kernel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pwiz::math::MatchedFilter::details::computeCorrelation           </td>
          <td>(</td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::samples_type::const_iterator&nbsp;</td>
          <td class="paramname"> <em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::samples_type::const_iterator&nbsp;</td>
          <td class="paramname"> <em>samplesEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::samples_type::const_iterator&nbsp;</td>
          <td class="paramname"> <em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename KernelTraits&lt; Kernel &gt;::correlation_type &amp;&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="_matched_filter_8hpp-source.html#l00256">256</a> of file <a class="el" href="_matched_filter_8hpp-source.html">MatchedFilter.hpp</a>.
<p>
References <a class="el" href="_matched_filter_8hpp-source.html#l00217">conj()</a>, and <a class="el" href="_matched_filter_8hpp-source.html#l00216">norm()</a>.<div class="fragment"><pre class="fragment"><a name="l00260"></a>00260 {
<a name="l00261"></a>00261     checkKernelConcept&lt;Kernel&gt;();
<a name="l00262"></a>00262     result.dot = 0; 
<a name="l00263"></a>00263     <span class="keywordtype">double</span> normData = 0;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="keywordflow">for</span> (; samples!=samplesEnd; ++samples, ++filter)
<a name="l00266"></a>00266     {
<a name="l00267"></a>00267         result.dot += (*samples) * <a class="code" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#3b7550b90b2036dbe4d21425be648f35">conj</a>(*filter); 
<a name="l00268"></a>00268         normData += <a class="code" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#313264101c8b982a32ec82d0d6f17529">norm</a>(*samples);
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="keywordtype">double</span> normDot = <a class="code" href="namespacepwiz_1_1math_1_1_matched_filter_1_1details.html#313264101c8b982a32ec82d0d6f17529">norm</a>(result.dot);
<a name="l00272"></a>00272     result.e2 = std::max(normData - normDot, 0.);
<a name="l00273"></a>00273     result.tan2angle = normDot&gt;0 ? result.e2/normDot : std::numeric_limits&lt;double&gt;::infinity();
<a name="l00274"></a>00274 }
</pre></div>
<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Fri Mar 14 17:16:09 2008 for ProteoWizard by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
